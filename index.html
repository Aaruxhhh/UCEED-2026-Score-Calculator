<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UCEED 2026 Score Calculator</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; scroll-behavior: smooth; }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { height: 6px; width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.02); border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.15); border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.25); }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in { animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        .animate-scale-in { animation: scaleIn 0.2s ease-out forwards; }
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Glass / Monochrome Panel Styles */
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        }
        
        .glass-input {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.9);
            border-color: rgba(0, 0, 0, 0.2);
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.05);
        }

        /* Subtle Gradient Background */
        .bg-mono-mesh {
            background-color: #fafafa;
            background-image: 
                radial-gradient(at 0% 0%, hsla(0,0%,90%,1) 0px, transparent 50%),
                radial-gradient(at 100% 100%, hsla(0,0%,92%,1) 0px, transparent 50%);
        }

        /* Tooltip Animation */
        .tooltip-content {
            visibility: hidden;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .tooltip-trigger:hover .tooltip-content,
        .tooltip-trigger:active .tooltip-content,
        .tooltip-trigger:focus .tooltip-content {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="bg-mono-mesh text-neutral-900 selection:bg-neutral-200 min-h-screen relative overflow-x-hidden">
    
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const Calculator = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
        );
        const User = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        );
        const BookOpen = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        );
        const ClipboardCopy = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-2"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></svg>
        );
        const AlertCircle = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
        );
        const Check = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polyline points="20 6 9 17 4 12"/></svg>
        );
        const X = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        );
        const Info = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        );
        const Pencil = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>
        );
        const AlertTriangle = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
        );

        // --- CONSTANTS ---
        const OFFICIAL_ANSWER_KEY = {
            "1": "14", "2": "2", "3": "6", "4": "16", "5": "62", "6": "4", "7": "31", "8": "8", "9": "13", "10": "745", 
            "11": "5", "12": "16.8", "13": "34", "14": "470-480",
            "15": ["A", "B", "C"], "16": ["B", "C"], "17": ["A", "B", "D"], 
            "18": [["B", "C"], ["B", "C", "D"]],
            "19": ["A", "C"], "20": ["A", "D"], "21": ["A", "B", "C", "D"], "22": ["A", "B", "C"], "23": ["B", "C", "D"], "24": ["B", "D"], "25": ["A", "C"], "26": ["A", "B", "C"], "27": ["A", "B", "C"], "28": ["A", "D"], "29": ["B", "C"],
            "30": "A", "31": "B", "32": "C", "33": "B", "34": "D", "35": "A", "36": "C", "37": "B", "38": "B", "39": "D", "40": "C", "41": "C", "42": "C", "43": "D", "44": "B", "45": "C", "46": "B", "47": "C", "48": "C", "49": "C", "50": "B", "51": "B", "52": "A", "53": "D", "54": "B", "55": "D", "56": "B", "57": "A"
        };

        function App() {
            const [activeTab, setActiveTab] = useState('step1');
            const [userJsonInput, setUserJsonInput] = useState('');
            const [questionsMap, setQuestionsMap] = useState(null); 
            const [scoreData, setScoreData] = useState(null);
            const [error, setError] = useState(null);
            const [editingQuestion, setEditingQuestion] = useState(null); 

            const extractionPrompt = `I need you to perform a high-precision data extraction for UCEED 2026. This requires following a strict mathematical logic to ensure 100% accuracy.

**FILES TO ANALYZE:**
1.  **Response Sheet (File 1):** Contains the user's answers and a "Question ID" for each. The questions here are SHUFFLED.
2.  **Official Question Paper (File 2):** Contains questions in the correct order (Q1 to Q57).

**THE MASTER LOGIC:**
The "Question IDs" on the Response Sheet, when sorted in increasing order, correspond exactly to the sequence of the Official Question Paper (Q1, Q2, Q3...).

**YOUR TASK (Step-by-Step):**
1.  List every question found in the **Response Sheet**.
2.  For each, extract:
    * **Question ID:** (The unique long number provided in the sheet).
    * **User Answer:** (The value or letters selected by the user).
3.  **Sort** this list in ascending order of the **Question ID**.
4.  The 1st Question ID in your sorted list is **Q1**, the 2nd is **Q2**, and so on up to **Q57**.
5.  **Visual Cross-Check:** Quickly verify the text/images of your mapped Q1, Q2, etc., against the Official Question Paper to confirm they match.

**EXTRACTION RULES:**
* **NAT (Q1-14):** Numerical value (e.g., "14" or "25.5").
* **MSQ (Q15-29):** Array of letters (e.g., ["A", "C"]).
* **MCQ (Q30-57):** Single letter (e.g., "B").
* **Unattempted:** If the status is "Not Answered", set \`user_answer\` to \`null\`.

**OUTPUT FORMAT:**
Provide ONLY a raw JSON object. No markdown, no explanations. Just the JSON.

{
  "1": { "type": "NAT", "user_answer": "14" },
  "2": { "type": "NAT", "user_answer": "25.5" },
  ...
  "15": { "type": "MSQ", "user_answer": ["A", "B"] },
  ...
  "30": { "type": "MCQ", "user_answer": "C" }
}`;

            // Initialize Data
            const handleInitialCalculation = () => {
                setError(null);
                try {
                    if (!userJsonInput.trim()) {
                        throw new Error("Please paste the User Data JSON.");
                    }

                    let userData;
                    try {
                        const cleanUser = userJsonInput.replace(/```json/g, '').replace(/```/g, '');
                        userData = JSON.parse(cleanUser);
                    } catch (e) {
                        throw new Error("Invalid User JSON format. Please check the text.");
                    }

                    const initialMap = {};
                    
                    for (let i = 1; i <= 57; i++) {
                        const qId = i.toString();
                        const userQ = userData[qId] || {};
                        
                        let type = userQ.type;
                        if (!type) {
                            if (i >= 1 && i <= 14) type = 'NAT';
                            else if (i >= 15 && i <= 29) type = 'MSQ';
                            else if (i >= 30 && i <= 57) type = 'MCQ';
                        }
                        
                        const finalCorrect = OFFICIAL_ANSWER_KEY[qId];

                        initialMap[qId] = {
                            id: qId,
                            type: type,
                            user_answer: userQ.user_answer,
                            correct_answer: finalCorrect, 
                        };
                    }
                    
                    setQuestionsMap(initialMap);
                    
                } catch (err) {
                    setError(err.message);
                }
            };

            // Recalculate whenever questionsMap changes
            useEffect(() => {
                if (!questionsMap) return;
                calculateStats(questionsMap);
            }, [questionsMap]);

            const calculateStats = (dataMap) => {
                let totalScore = 0;
                const sections = {
                    NAT: { attempted: 0, correct: 0, score: 0, total: 56 },
                    MSQ: { attempted: 0, correct: 0, score: 0, total: 60 },
                    MCQ: { attempted: 0, correct: 0, score: 0, total: 84 },
                };

                const detailedResults = [];

                Object.values(dataMap).forEach(q => {
                    if (!q.type) return;
                    
                    const qNum = parseInt(q.id);
                    let marks = 0;
                    let status = 'unattempted'; 

                    const userAns = q.user_answer;
                    const correctAns = q.correct_answer;

                    if (userAns === null || userAns === undefined || userAns === '') {
                        status = 'unattempted';
                        marks = 0;
                    } else if (!correctAns) {
                        status = 'unknown';
                        marks = 0;
                    } else {
                        sections[q.type].attempted++;
                        
                        if (q.type === 'NAT') {
                            const uVal = parseFloat(userAns);
                            let isMatch = false;
                            
                            if (typeof correctAns === 'string' && correctAns.includes('-')) {
                                const [min, max] = correctAns.split('-').map(Number);
                                    if (!isNaN(min) && !isNaN(max)) {
                                        isMatch = uVal >= min && uVal <= max;
                                    }
                            } else {
                                const cVal = parseFloat(correctAns);
                                isMatch = uVal === cVal || userAns.toString().trim() === correctAns.toString().trim();
                            }
                            
                            if (isMatch) {
                                marks = 4;
                                status = 'correct';
                                sections[q.type].correct++;
                            } else {
                                marks = 0;
                                status = 'wrong';
                            }
                        } 
                        else if (q.type === 'MCQ') {
                            if (userAns === correctAns) {
                                marks = 3;
                                status = 'correct';
                                sections[q.type].correct++;
                            } else {
                                marks = -0.71;
                                status = 'wrong';
                            }
                        } 
                        else if (q.type === 'MSQ') {
                            const uArr = Array.isArray(userAns) ? userAns : [userAns];
                            
                            let possibleKeys = [];
                            if (Array.isArray(correctAns) && Array.isArray(correctAns[0])) {
                                possibleKeys = correctAns;
                            } else {
                                possibleKeys = [Array.isArray(correctAns) ? correctAns : [correctAns]];
                            }

                            let bestScenarioMarks = -100;
                            let bestScenarioStatus = 'wrong';

                            for (const cArr of possibleKeys) {
                                let currentMarks = 0;
                                let currentStatus = 'wrong';

                                const hasWrongOption = uArr.some(opt => !cArr.includes(opt));
                                
                                if (hasWrongOption) {
                                    currentMarks = -1;
                                    currentStatus = 'wrong';
                                } else {
                                    const correctSelectedCount = uArr.length;
                                    const totalCorrectOptions = cArr.length;

                                    if (correctSelectedCount === totalCorrectOptions) {
                                        currentMarks = 4;
                                        currentStatus = 'correct';
                                    } else {
                                        currentStatus = 'partial';
                                        if (totalCorrectOptions === 4 && correctSelectedCount === 3) currentMarks = 3;
                                        else if (totalCorrectOptions >= 3 && correctSelectedCount === 2) currentMarks = 2;
                                        else if (totalCorrectOptions >= 2 && correctSelectedCount === 1) currentMarks = 1;
                                        else currentMarks = 0; 
                                    }
                                }

                                if (currentMarks > bestScenarioMarks) {
                                    bestScenarioMarks = currentMarks;
                                    bestScenarioStatus = currentStatus;
                                }
                            }

                            marks = bestScenarioMarks;
                            status = bestScenarioStatus;

                            if (status === 'correct') sections[q.type].correct++;
                        }
                    }

                    sections[q.type].score += marks;
                    totalScore += marks;
                    
                    let displayKey = correctAns;
                    if (Array.isArray(correctAns)) {
                            if (Array.isArray(correctAns[0])) {
                                displayKey = correctAns.map(k => k.join('')).join(' OR ');
                            } else {
                                displayKey = correctAns.join('');
                            }
                    }

                    detailedResults.push({
                        ...q,
                        marks,
                        status,
                        userAnsDisplay: Array.isArray(q.user_answer) ? q.user_answer.join(', ') : q.user_answer,
                        correctAnsDisplay: displayKey
                    });
                });

                totalScore = parseFloat(totalScore.toFixed(2));
                sections.NAT.score = parseFloat(sections.NAT.score.toFixed(2));
                sections.MSQ.score = parseFloat(sections.MSQ.score.toFixed(2));
                sections.MCQ.score = parseFloat(sections.MCQ.score.toFixed(2));

                setScoreData({ totalScore, sections, detailedResults });
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text).then(() => {
                }).catch(err => {
                   console.error('Failed to copy: ', err);
                });
            };

            const getSectionTooltip = (name) => {
                switch(name) {
                    case 'NAT':
                        return (
                            <div className="space-y-1">
                                <div className="font-bold border-b border-neutral-100 pb-1 mb-1">Marking Scheme</div>
                                <div className="flex justify-between gap-4"><span className="text-emerald-600">Correct:</span> <span>+4</span></div>
                                <div className="flex justify-between gap-4"><span className="text-rose-600">Wrong:</span> <span>0</span></div>
                                <div className="flex justify-between gap-4"><span className="text-neutral-400">Unattempted:</span> <span>0</span></div>
                            </div>
                        );
                    case 'MSQ':
                        return (
                            <div className="space-y-1">
                                <div className="font-bold border-b border-neutral-100 pb-1 mb-1">Marking Scheme</div>
                                <div className="flex justify-between gap-4"><span className="text-emerald-600">All Correct:</span> <span>+4</span></div>
                                <div className="flex justify-between gap-4"><span className="text-amber-600">Partial:</span> <span>+1 to +3</span></div>
                                <div className="flex justify-between gap-4"><span className="text-rose-600">Any Wrong:</span> <span>-1</span></div>
                            </div>
                        );
                    case 'MCQ':
                        return (
                            <div className="space-y-1">
                                <div className="font-bold border-b border-neutral-100 pb-1 mb-1">Marking Scheme</div>
                                <div className="flex justify-between gap-4"><span className="text-emerald-600">Correct:</span> <span>+3</span></div>
                                <div className="flex justify-between gap-4"><span className="text-rose-600">Wrong:</span> <span>-0.71</span></div>
                                <div className="flex justify-between gap-4"><span className="text-neutral-400">Unattempted:</span> <span>0</span></div>
                            </div>
                        );
                    default: return null;
                }
            };

            const handleSaveEdit = (newAnswer) => {
                if (!editingQuestion) return;
                setQuestionsMap(prev => {
                    const updated = { ...prev };
                    updated[editingQuestion.id] = { ...updated[editingQuestion.id], user_answer: newAnswer };
                    return updated;
                });
                setEditingQuestion(null);
            };

            const Modal = ({ question, onClose, onSave }) => {
                const [val, setVal] = useState(question.user_answer || (question.type === 'MSQ' ? [] : ''));
                const toggleOption = (opt) => {
                    if (question.type === 'MSQ') {
                        let current = Array.isArray(val) ? val : [];
                        if (current.includes(opt)) setVal(current.filter(x => x !== opt).sort());
                        else setVal([...current, opt].sort());
                    } else setVal(opt);
                };

                return (
                    <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/20 backdrop-blur-sm animate-fade-in">
                        <div className="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm m-4 animate-scale-in border border-white/40">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="text-lg font-bold text-neutral-900">Edit Question {question.id}</h3>
                                <button onClick={onClose} className="p-1 hover:bg-neutral-100 rounded-full"><X className="w-5 h-5 text-neutral-500"/></button>
                            </div>
                            <div className="mb-6">
                                <div className="text-xs font-semibold text-neutral-500 uppercase tracking-wide mb-2">My Answer</div>
                                {question.type === 'NAT' && (
                                    <input type="number" value={val || ''} onChange={e => setVal(e.target.value)} className="w-full p-3 rounded-xl border border-neutral-200 bg-neutral-50 focus:ring-2 focus:ring-neutral-900 outline-none font-mono text-lg" placeholder="Enter number" />
                                )}
                                {(question.type === 'MCQ' || question.type === 'MSQ') && (
                                    <div className="grid grid-cols-4 gap-2">
                                        {['A','B','C','D'].map(opt => {
                                            const isSelected = question.type === 'MSQ' ? (Array.isArray(val) && val.includes(opt)) : val === opt;
                                            return <button key={opt} onClick={() => toggleOption(opt)} className={`py-3 rounded-xl font-bold transition-all ${isSelected ? 'bg-neutral-900 text-white shadow-lg' : 'bg-neutral-100 text-neutral-600 hover:bg-neutral-200'}`}>{opt}</button>
                                        })}
                                    </div>
                                )}
                            </div>
                            <div className="flex gap-3">
                                <button onClick={() => onSave(null)} className="flex-1 py-3 text-sm font-bold text-rose-600 bg-rose-50 hover:bg-rose-100 rounded-xl transition-colors">Clear</button>
                                <button onClick={() => onSave(val)} className="flex-2 w-2/3 py-3 text-sm font-bold text-white bg-neutral-900 hover:bg-black rounded-xl shadow-lg transition-transform active:scale-95">Save Changes</button>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen">
                    <header className="glass-panel sticky top-0 z-50 border-b-0">
                        <div className="max-w-5xl mx-auto px-6 py-4 flex items-center justify-between">
                            <div className="flex items-center gap-3 group cursor-default">
                                <div className="bg-neutral-900 text-white p-2 rounded-xl transition-transform duration-300 group-hover:scale-110 shadow-lg"><Calculator className="w-5 h-5" /></div>
                                <h1 className="text-xl font-extrabold tracking-tight text-neutral-900 transition-transform duration-300 group-hover:translate-x-1">UCEED Calculator</h1>
                            </div>
                            <a href="https://www.reddit.com/user/ruxh_alt/" target="_blank" rel="noopener noreferrer" className="text-xs font-semibold text-neutral-500 hover:text-neutral-900 transition-colors flex items-center gap-2 bg-white/50 px-4 py-2 rounded-full border border-neutral-200 hover:bg-white hover:shadow-sm">
                                <User className="w-3.5 h-3.5" /> Made by @Ruxh_alt
                            </a>
                        </div>
                    </header>

                    <main className="max-w-5xl mx-auto p-4 sm:p-6 space-y-10 relative z-10">
                        {editingQuestion && <Modal question={editingQuestion} onClose={() => setEditingQuestion(null)} onSave={handleSaveEdit} />}

                        <section className="py-12 flex flex-col items-center text-center max-w-3xl mx-auto space-y-6 animate-fade-in">
                            <div className="w-full flex justify-center">
                                <div className="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white border border-neutral-200 text-neutral-600 text-xs font-semibold shadow-sm hover:shadow-md transition-shadow">
                                    <span className="relative flex h-2 w-2">
                                      <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-neutral-400 opacity-75"></span>
                                      <span className="relative inline-flex rounded-full h-2 w-2 bg-neutral-800"></span>
                                    </span>
                                    Updated: Final Answer Key (Jan 28)
                                </div>
                            </div>
                            
                            <div className="w-full flex justify-center pointer-events-none">
                                <h2 className="text-5xl sm:text-6xl font-extrabold tracking-tight text-neutral-900 leading-[1.1] inline-block group cursor-default text-center pointer-events-none">
                                    <span className="inline-block transition-transform duration-300 pointer-events-auto">UCEED Score</span> <br/>
                                    <span className="text-neutral-400 inline-block transition-all duration-300 group-hover:text-neutral-800 group-hover:tracking-widest pointer-events-auto">Calculator</span>
                                </h2>
                            </div>

                            <p className="text-lg text-neutral-500 leading-relaxed max-w-2xl mx-auto font-medium">
                                Shuffled response sheet? No problem. This tool sorts your answers by Question ID and maps them perfectly to the official question paper.
                            </p>

                            <div className="group inline-block cursor-default max-w-lg mx-auto w-full px-4">
                                <div className="bg-neutral-50 border border-neutral-200 rounded-xl p-3 flex items-center justify-center gap-2 text-sm text-neutral-500 transition-all duration-300 group-hover:bg-white group-hover:shadow-lg group-hover:border-neutral-300 group-hover:scale-105">
                                    <AlertTriangle className="w-4 h-4 text-neutral-400 transition-colors group-hover:text-rose-500" />
                                    <span>This calculator is <span className="inline-block px-1 font-bold transition-all duration-300 group-hover:text-rose-600 group-hover:text-base group-hover:scale-110 hover:!text-rose-800 cursor-default">not</span> 100% accurate.</span>
                                </div>
                                <p className="text-xs text-neutral-400 overflow-hidden transition-all duration-500 ease-in-out max-h-0 opacity-0 group-hover:max-h-[40px] group-hover:opacity-100 group-hover:mt-2">
                                    AI sometimes misreads handwritten NAT answers. Use the "Edit" pencil in Results to manually fix any errors.
                                </p>
                            </div>
                        </section>

                        <div className="flex justify-center animate-fade-in" style={{animationDelay: '0.1s'}}>
                            <div className="glass-panel p-1.5 rounded-full inline-flex relative shadow-sm">
                                <button onClick={() => setActiveTab('step1')} className={`px-6 py-2.5 rounded-full text-sm font-bold transition-all duration-300 flex items-center gap-2 ${activeTab === 'step1' ? 'bg-neutral-900 text-white shadow-lg' : 'text-neutral-500 hover:text-neutral-800'}`}>
                                    <div className={`w-5 h-5 rounded-full flex items-center justify-center text-[10px] border ${activeTab === 'step1' ? 'border-neutral-500 text-neutral-200' : 'border-neutral-300'}`}>1</div> Get Data
                                </button>
                                <button onClick={() => setActiveTab('step2')} className={`px-6 py-2.5 rounded-full text-sm font-bold transition-all duration-300 flex items-center gap-2 ${activeTab === 'step2' ? 'bg-neutral-900 text-white shadow-lg' : 'text-neutral-500 hover:text-neutral-800'}`}>
                                    <div className={`w-5 h-5 rounded-full flex items-center justify-center text-[10px] border ${activeTab === 'step2' ? 'border-neutral-500 text-neutral-200' : 'border-neutral-300'}`}>2</div> Results
                                </button>
                            </div>
                        </div>

                        {activeTab === 'step1' && (
                            <div className="space-y-6 animate-fade-in max-w-4xl mx-auto" style={{animationDelay: '0.2s'}}>
                                <div className="glass-panel rounded-3xl p-8 hover:shadow-xl hover:-translate-y-1 transition-all duration-500">
                                    <h3 className="text-lg font-bold text-neutral-900 mb-6 flex items-center gap-2"><BookOpen className="w-5 h-5" /> How it works</h3>
                                    <div className="grid md:grid-cols-2 gap-8 text-sm text-neutral-600">
                                        <div className="space-y-3">
                                            <div className="font-bold text-neutral-900 text-base">1. Prepare Files</div>
                                            <p className="leading-relaxed">Download your <span className="font-bold text-neutral-900">Response Sheet PDF</span> and the <a href="https://www.uceed.iitb.ac.in/2026/assets/downloads/qps/UCEED_2026_Question_Paper.pdf" target="_blank" rel="noopener noreferrer" className="font-bold text-neutral-900 hover:text-indigo-600 underline decoration-indigo-300 underline-offset-2 transition-colors">Official Question Paper PDF</a>.</p>
                                        </div>
                                        <div className="space-y-3">
                                            <div className="font-bold text-neutral-900 text-base">2. Ask AI</div>
                                            <p className="leading-relaxed">Paste the prompt below into Gemini (Thinking/Pro mode) along with your PDFs. <br/><span className="text-neutral-900 font-bold text-xs bg-white px-2 py-1 rounded border border-neutral-200 mt-2 inline-block shadow-sm">Updated: Logic improved for 100% accuracy.</span></p>
                                        </div>
                                    </div>
                                </div>

                                <div className="space-y-3">
                                    <div className="flex items-center justify-between px-2">
                                        <span className="text-sm font-bold text-neutral-700 ml-1">Prompt for Gemini (Updated)</span>
                                        <button onClick={() => copyToClipboard(extractionPrompt)} className="flex items-center gap-2 bg-neutral-900 hover:bg-black text-white px-4 py-2 rounded-xl text-xs font-bold transition-all shadow-lg hover:shadow-xl active:scale-95 group">
                                            <ClipboardCopy className="w-3.5 h-3.5 transition-transform group-hover:rotate-6" /> Copy Prompt
                                        </button>
                                    </div>
                                    <div className="glass-panel rounded-2xl overflow-hidden shadow-sm">
                                        <div className="p-6 overflow-x-auto max-h-[300px] overflow-y-auto custom-scrollbar bg-white/60">
                                            <pre className="text-neutral-600 text-xs sm:text-sm font-mono whitespace-pre-wrap leading-relaxed">{extractionPrompt}</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'step2' && (
                            <div className="space-y-10 animate-fade-in max-w-4xl mx-auto" style={{animationDelay: '0.2s'}}>
                                <div className="space-y-3">
                                    <label className="block text-sm font-bold text-neutral-800 ml-2">Paste AI Output (User Data)</label>
                                    <textarea value={userJsonInput} onChange={(e) => setUserJsonInput(e.target.value)} placeholder='Paste the JSON here...' className="w-full h-48 p-5 rounded-2xl glass-input text-xs shadow-sm resize-none outline-none font-mono text-neutral-600 placeholder:text-neutral-400 focus:ring-2 focus:ring-neutral-900 focus:border-transparent" />
                                </div>

                                <button onClick={handleInitialCalculation} className="w-full bg-neutral-900 hover:bg-black text-white font-bold py-4 rounded-2xl shadow-xl hover:shadow-2xl transition-all active:scale-[0.99] flex items-center justify-center gap-2 group">
                                    <Calculator className="w-5 h-5 group-hover:rotate-12 transition-transform" /> Calculate Score
                                </button>

                                {error && (
                                    <div className="bg-white/80 border border-neutral-200 p-4 rounded-2xl text-neutral-800 text-sm flex items-center gap-3 animate-fade-in shadow-sm">
                                        <AlertCircle className="h-5 w-5 shrink-0 text-neutral-500" /> {error}
                                    </div>
                                )}

                                {scoreData && (
                                    <div className="space-y-8 pt-8 border-t border-neutral-200/50 animate-fade-in">
                                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                            <div className="bg-neutral-900 rounded-3xl p-6 text-white shadow-xl md:col-span-1 flex flex-col justify-between relative overflow-hidden group hover:scale-[1.02] transition-transform duration-300">
                                                <div className="relative z-10">
                                                    <div className="text-neutral-400 text-sm font-bold mb-1 uppercase tracking-wider">Total Score</div>
                                                    <div className="text-5xl font-extrabold tracking-tighter">{scoreData.totalScore}</div>
                                                    <div className="text-slate-500 text-xs mt-2 font-medium">Part A (Max 200)</div>
                                                </div>
                                                <div className="absolute -bottom-10 -right-10 w-40 h-40 bg-white rounded-full blur-3xl opacity-5 group-hover:opacity-10 transition-opacity"></div>
                                            </div>

                                            {Object.entries(scoreData.sections).map(([name, data]) => (
                                                <div key={name} className="glass-panel rounded-3xl p-6 hover:-translate-y-1 transition-all duration-300 relative group">
                                                    <div className="absolute top-4 right-4 tooltip-trigger cursor-help">
                                                        <div className="p-1.5 rounded-full hover:bg-neutral-100 transition-colors text-neutral-400 hover:text-neutral-600"><Info className="w-4 h-4" /></div>
                                                        <div className="tooltip-content absolute bottom-full right-0 mb-2 w-56 p-3 bg-white rounded-xl shadow-xl border border-neutral-100 text-xs text-neutral-600 z-50 pointer-events-none">
                                                            {getSectionTooltip(name)}
                                                            <div className="absolute bottom-[-4px] right-3 w-2 h-2 bg-white border-b border-r border-neutral-100 rotate-45"></div>
                                                        </div>
                                                    </div>
                                                    <div className="flex justify-between items-start mb-4">
                                                        <div className="bg-white/80 px-3 py-1 rounded-lg text-xs font-bold text-neutral-800 border border-neutral-200 shadow-sm">{name}</div>
                                                    </div>
                                                    <div className="text-3xl font-bold text-neutral-900 mb-1">{data.score}</div>
                                                    <div className="text-xs text-neutral-500 flex justify-between font-medium"><span>Correct: {data.correct}/{data.attempted}</span> <span>Max: {data.total}</span></div>
                                                    <div className="w-full bg-neutral-100 h-2 rounded-full mt-4 overflow-hidden"><div className="bg-neutral-800 h-full rounded-full transition-all duration-1000 ease-out" style={{ width: `${Math.max(0, (data.score / data.total) * 100)}%` }}></div></div>
                                                </div>
                                            ))}
                                        </div>

                                        <div className="glass-panel rounded-3xl overflow-hidden shadow-lg">
                                            <div className="px-6 py-4 border-b border-neutral-100 bg-white/40 flex justify-between items-center">
                                                <h3 className="font-bold text-neutral-900">Breakdown</h3>
                                                <span className="text-xs text-neutral-500 font-mono bg-white px-2 py-1 rounded border border-neutral-200">ID:1-57</span>
                                            </div>
                                            <div className="overflow-x-auto max-h-[600px] custom-scrollbar">
                                                <table className="w-full text-sm text-left">
                                                    <thead className="text-neutral-500 font-semibold border-b border-neutral-100 sticky top-0 z-10">
                                                        <tr>
                                                            <th className="px-6 py-4 bg-white/90 backdrop-blur">Q</th>
                                                            <th className="px-6 py-4 bg-white/90 backdrop-blur">Type</th>
                                                            <th className="px-6 py-4 bg-white/90 backdrop-blur">You</th>
                                                            <th className="px-6 py-4 bg-white/90 backdrop-blur">Key</th>
                                                            <th className="px-6 py-4 bg-white/90 backdrop-blur">Marks</th>
                                                            <th className="px-6 py-4 text-right bg-white/90 backdrop-blur">Status</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody className="divide-y divide-neutral-100">
                                                        {scoreData.detailedResults.map((row) => (
                                                            <tr key={row.id} className="hover:bg-white/60 transition-colors">
                                                                <td className="px-6 py-4 font-bold text-neutral-800">{row.id}</td>
                                                                <td className="px-6 py-4"><span className="text-[10px] font-bold text-neutral-500 bg-neutral-100 px-2 py-1 rounded border border-neutral-200">{row.type}</span></td>
                                                                <td className="px-6 py-4">
                                                                    <div className="flex items-center gap-2">
                                                                        <span className="font-mono text-neutral-600">{row.userAnsDisplay === null || row.userAnsDisplay === undefined || row.userAnsDisplay === '' ? <span className="text-neutral-300">-</span> : row.userAnsDisplay}</span>
                                                                        <button onClick={() => setEditingQuestion(row)} className="p-1.5 rounded-full hover:bg-neutral-100 text-neutral-300 hover:text-neutral-600 transition-colors" title="Edit Answer"><Pencil className="w-3.5 h-3.5" /></button>
                                                                    </div>
                                                                </td>
                                                                <td className="px-6 py-4 font-mono text-neutral-600">{row.correctAnsDisplay || <span className="text-neutral-300">?</span>}</td>
                                                                <td className={`px-6 py-4 font-bold ${row.marks > 0 ? 'text-emerald-600' : row.marks < 0 ? 'text-rose-500' : 'text-neutral-300'}`}>{row.marks > 0 ? '+' : ''}{row.marks}</td>
                                                                <td className="px-6 py-4 text-right">
                                                                    {row.status === 'correct' && <span className="inline-flex items-center gap-1.5 text-emerald-700 text-xs font-bold bg-emerald-50 px-3 py-1 rounded-full border border-emerald-100"><Check className="w-3 h-3" /> Correct</span>}
                                                                    {row.status === 'wrong' && <span className="inline-flex items-center gap-1.5 text-rose-600 text-xs font-bold bg-rose-50 px-3 py-1 rounded-full border border-rose-100"><X className="w-3 h-3" /> Wrong</span>}
                                                                    {row.status === 'partial' && <span className="inline-flex items-center gap-1.5 text-amber-600 text-xs font-bold bg-amber-50 px-3 py-1 rounded-full border border-amber-100">Partial</span>}
                                                                    {row.status === 'unattempted' && <span className="text-neutral-300 text-xs font-medium italic">Unattempted</span>}
                                                                    {row.status === 'unknown' && <span className="text-neutral-300 text-xs">No Key</span>}
                                                                </td>
                                                            </tr>
                                                        ))}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    <footer className="max-w-5xl mx-auto p-8 text-center mt-12 bg-white/30 backdrop-blur-md border-t border-white/40">
                        <p className="text-neutral-400 text-xs font-medium">Unofficial Tool. Not affiliated with UCEED or IIT Bombay. <br/> <a href="https://www.reddit.com/user/ruxh_alt/" target="_blank" rel="noopener noreferrer" className="hover:text-neutral-900 underline transition-colors">Made by @Ruxh_alt</a></p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
